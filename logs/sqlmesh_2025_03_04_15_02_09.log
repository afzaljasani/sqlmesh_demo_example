2025-03-04 15:02:09,087 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:316)
2025-03-04 15:02:09,468 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:306)
2025-03-04 15:02:12,427 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:322)
2025-03-04 15:02:12,428 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-03-04 15:02:12,429 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-03-04 15:02:12,430 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__incremental_test__821161111', 'sqlmesh_example__sfdc_pipeline__3294888737', 'sqlmesh_example__new_full_model__3421731154', 'sqlmesh_example__full_model__1100116909', 'sqlmesh_example__seed_model__1248844913', 'sqlmesh_example__sfdc_opp_model__1106821760', 'sqlmesh_example__incremental_model__3165396090', 'sqlmesh_example__sfdc_opp_history__796608424') (base.py:2113)
2025-03-04 15:02:12,460 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1060)
2025-03-04 15:02:12,460 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2113)
2025-03-04 15:02:12,465 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_test__821161111' (evaluator.py:1402)
2025-03-04 15:02:12,466 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111" AS SELECT "sfdc_opp_model"."opportunity_id" AS "opportunity_id", "sfdc_opp_model"."opportunity_probability" * "sfdc_opp_model"."opportunity_amount" AS "forecasted_amount", AVG("sfdc_opp_model"."opportunity_amount") OVER (ORDER BY "sfdc_opp_model"."opportunity_id") AS "total_amount" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_model__1106821760" AS "sfdc_opp_model" WHERE FALSE LIMIT 0 (base.py:2113)
2025-03-04 15:02:12,467 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111"."opportunity_id" IS 'primary key' (base.py:2113)
2025-03-04 15:02:12,486 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (evaluator.py:594)
2025-03-04 15:02:12,489 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-12-19 00:00:00, 2024-12-20 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_test__821161111' (evaluator.py:648)
2025-03-04 15:02:12,489 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111" (base.py:2113)
2025-03-04 15:02:12,490 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111" AS SELECT CAST("opportunity_id" AS INT) AS "opportunity_id", CAST("forecasted_amount" AS REAL) AS "forecasted_amount", CAST("total_amount" AS DOUBLE) AS "total_amount" FROM (SELECT "sfdc_opp_model"."opportunity_id" AS "opportunity_id", "sfdc_opp_model"."opportunity_probability" * "sfdc_opp_model"."opportunity_amount" AS "forecasted_amount", AVG("sfdc_opp_model"."opportunity_amount") OVER (ORDER BY "sfdc_opp_model"."opportunity_id") AS "total_amount" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_model__1106821760" AS "sfdc_opp_model") AS "_subquery" (base.py:2113)
2025-03-04 15:02:12,492 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111"."opportunity_id" IS 'primary key' (base.py:2113)
2025-03-04 15:02:12,517 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2024-12-19 00:00:00, 2024-12-20 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (interval.py:71)
2025-03-04 15:02:12,517 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (interval.py:255)
2025-03-04 15:02:12,524 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:164)
2025-03-04 15:02:12,539 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (snapshot.py:143)
2025-03-04 15:02:12,541 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:1060)
2025-03-04 15:02:12,541 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2113)
2025-03-04 15:02:12,541 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__1100116909' (evaluator.py:1367)
2025-03-04 15:02:12,542 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__1100116909" (base.py:2113)
2025-03-04 15:02:12,542 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.incremental_test' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_test__821161111' (evaluator.py:1367)
2025-03-04 15:02:12,543 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."incremental_test" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111" (base.py:2113)
2025-03-04 15:02:12,543 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh_example"."incremental_test"."opportunity_id" IS 'primary key' (base.py:2113)
2025-03-04 15:02:12,544 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:98)
2025-03-04 15:02:12,579 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
