2025-03-14 09:59:06,399 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:316)
2025-03-14 09:59:06,543 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:306)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 15 intervals for 15 snapshots (interval.py:172)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3087240161> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3680421058> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 2125885490> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 1276033394> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 2410547376> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."new_full_model": 545034850> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."new_full_model": 1415902004> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_opp_history": 702798800> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_opp_history": 3848103835> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_pipeline": 4274885841> (interval.py:255)
2025-03-14 09:59:06,573 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_pipeline": 2962116842> (interval.py:255)
2025-03-14 09:59:06,585 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2820438291__dev" (base.py:2113)
2025-03-14 09:59:06,585 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2820438291__dev' (evaluator.py:1458)
2025-03-14 09:59:06,587 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2820438291" (base.py:2113)
2025-03-14 09:59:06,587 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2820438291' (evaluator.py:1458)
2025-03-14 09:59:06,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__1342987875__temp" (base.py:2113)
2025-03-14 09:59:06,588 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_test__1342987875__temp' (evaluator.py:1458)
2025-03-14 09:59:06,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__1342987875" (base.py:2113)
2025-03-14 09:59:06,588 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_test__1342987875' (evaluator.py:1458)
2025-03-14 09:59:06,589 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_history__3673776337__temp" (base.py:2113)
2025-03-14 09:59:06,589 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__sfdc_opp_history__3673776337__temp' (evaluator.py:1458)
2025-03-14 09:59:06,589 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_history__3673776337" (base.py:2113)
2025-03-14 09:59:06,589 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__sfdc_opp_history__3673776337' (evaluator.py:1458)
2025-03-14 09:59:06,590 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3250590793__temp" (base.py:2113)
2025-03-14 09:59:06,590 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__sfdc_pipeline__3250590793__temp' (evaluator.py:1458)
2025-03-14 09:59:06,590 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3250590793" (base.py:2113)
2025-03-14 09:59:06,590 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__sfdc_pipeline__3250590793' (evaluator.py:1458)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 11 intervals for 6 snapshots (interval.py:172)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,593 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:255)
2025-03-14 09:59:06,685 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3600046989> (evaluator.py:594)
2025-03-14 09:59:06,692 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-12-17 00:00:00, 2025-03-14 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3165396090' (evaluator.py:648)
2025-03-14 09:59:06,693 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3165396090" WHERE "event_date" BETWEEN CAST('2024-12-17' AS DATE) AND CAST('2025-03-13' AS DATE) (base.py:2113)
2025-03-14 09:59:06,694 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3165396090" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2025-03-13' AS DATE) AND "seed_model"."event_date" >= CAST('2024-12-17' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2024-12-17' AS DATE) AND CAST('2025-03-13' AS DATE) (base.py:2113)
2025-03-14 09:59:06,719 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2024-12-17 00:00:00, 2025-03-14 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3600046989> (interval.py:71)
2025-03-14 09:59:06,719 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3600046989> (interval.py:255)
2025-03-14 09:59:06,726 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (evaluator.py:594)
2025-03-14 09:59:06,729 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-03-13 00:00:00, 2025-03-14 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_test__821161111' (evaluator.py:648)
2025-03-14 09:59:06,730 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__incremental_test__821161111_sbow9io3" AS SELECT "sfdc_opp_model"."opportunity_id" AS "opportunity_id", "sfdc_opp_model"."opportunity_probability" * "sfdc_opp_model"."opportunity_amount" AS "forecasted_amount", AVG("sfdc_opp_model"."opportunity_amount") OVER (ORDER BY "sfdc_opp_model"."opportunity_id") AS "total_amount" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_model__1106821760" AS "sfdc_opp_model" (base.py:2113)
2025-03-14 09:59:06,732 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111" WHERE "opportunity_id" IN (SELECT "opportunity_id" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__incremental_test__821161111_sbow9io3") (base.py:2113)
2025-03-14 09:59:06,733 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_test__821161111" ("opportunity_id", "forecasted_amount", "total_amount") SELECT DISTINCT ON ("opportunity_id") "opportunity_id", "forecasted_amount", "total_amount" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__incremental_test__821161111_sbow9io3" (base.py:2113)
2025-03-14 09:59:06,736 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__incremental_test__821161111_sbow9io3" (base.py:2113)
2025-03-14 09:59:06,736 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2025-03-13 00:00:00, 2025-03-14 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (interval.py:71)
2025-03-14 09:59:06,737 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_test": 535125204> (interval.py:255)
2025-03-14 09:59:06,743 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."new_full_model": 587983574> (evaluator.py:594)
2025-03-14 09:59:06,745 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-03-13 00:00:00, 2025-03-14 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__new_full_model__3421731154' (evaluator.py:648)
2025-03-14 09:59:06,746 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_full_model__3421731154" AS SELECT CAST("ed" AS DATE) AS "ed", CAST("num_id" AS BIGINT) AS "num_id", CAST("total_rows" AS BIGINT) AS "total_rows" FROM (SELECT "seed_model"."event_date" AS "ed", COUNT(DISTINCT "seed_model"."id") AS "num_id", COUNT(*) AS "total_rows" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" AS "seed_model" GROUP BY "seed_model"."event_date") AS "_subquery" (base.py:2113)
2025-03-14 09:59:06,748 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_full_model__3421731154"."num_id" IS 'total number of IDs' (base.py:2113)
2025-03-14 09:59:06,748 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_full_model__3421731154"."total_rows" IS 'total number of rows in table' (base.py:2113)
2025-03-14 09:59:06,749 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2025-03-13 00:00:00, 2025-03-14 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."new_full_model": 587983574> (interval.py:71)
2025-03-14 09:59:06,749 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."new_full_model": 587983574> (interval.py:255)
2025-03-14 09:59:06,756 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_pipeline": 132841400> (evaluator.py:594)
2025-03-14 09:59:06,760 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-03-13 00:00:00, 2025-03-14 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__sfdc_pipeline__3294888737' (evaluator.py:648)
2025-03-14 09:59:06,761 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737" AS SELECT CAST("id" AS INT) AS "id", CAST("opportunity_name" AS TEXT) AS "opportunity_name", CAST("opportunity_stage" AS TEXT) AS "opportunity_stage", CAST("close_date" AS DATE) AS "close_date", CAST("expected_amount" AS DOUBLE) AS "expected_amount", CAST("opportunity_probability_new" AS DOUBLE) AS "opportunity_probability_new" FROM (SELECT "sfdc_opp_model"."opportunity_id" AS "id", "sfdc_opp_model"."opportunity_name" AS "opportunity_name", "sfdc_opp_model"."opportunity_stage" AS "opportunity_stage", "sfdc_opp_model"."close_date" AS "close_date", ROUND("sfdc_opp_model"."opportunity_probability" * "sfdc_opp_model"."opportunity_amount", 2) AS "expected_amount", CASE WHEN "sfdc_opp_model"."opportunity_stage" = 'demo' THEN 3.99 * "sfdc_opp_model"."opportunity_probability" ELSE NULL END AS "opportunity_probability_new" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_model__1106821760" AS "sfdc_opp_model") AS "_subquery" (base.py:2113)
2025-03-14 09:59:06,763 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737"."id" IS 'primary key of opportunity table' (base.py:2113)
2025-03-14 09:59:06,763 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737"."opportunity_name" IS 'name of the opportunity' (base.py:2113)
2025-03-14 09:59:06,763 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737"."opportunity_stage" IS 'stage name from salesforce' (base.py:2113)
2025-03-14 09:59:06,763 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737"."close_date" IS 'this is the projected closed date' (base.py:2113)
2025-03-14 09:59:06,763 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737"."opportunity_probability_new" IS 'custom probability forecasting' (base.py:2113)
2025-03-14 09:59:06,764 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_pipeline": 132841400> (evaluator.py:500)
2025-03-14 09:59:06,764 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737" (base.py:2113)
2025-03-14 09:59:06,767 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737" AS "sqlmesh_example__sfdc_pipeline__3294888737") AS "_q_0" WHERE "expected_amount" >= 100000) AS "audit" (base.py:2113)
2025-03-14 09:59:06,767 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737" (base.py:2113)
2025-03-14 09:59:06,770 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737" AS "sqlmesh_example__sfdc_pipeline__3294888737") AS "_q_0" WHERE ("opportunity_name") IS NULL AND TRUE) AS "audit" (base.py:2113)
2025-03-14 09:59:06,771 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2025-03-13 00:00:00, 2025-03-14 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_pipeline": 132841400> (interval.py:71)
2025-03-14 09:59:06,771 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_pipeline": 132841400> (interval.py:255)
2025-03-14 09:59:06,777 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3804180753> (evaluator.py:594)
2025-03-14 09:59:06,779 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-12-20 00:00:00, 2025-03-14 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__1100116909' (evaluator.py:648)
2025-03-14 09:59:06,779 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__1100116909" AS SELECT CAST("item_id" AS INT) AS "item_id", CAST("num_orders" AS BIGINT) AS "num_orders" FROM (SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3165396090" AS "incremental_model" GROUP BY "incremental_model"."item_id") AS "_subquery" (base.py:2113)
2025-03-14 09:59:06,781 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3804180753> (evaluator.py:500)
2025-03-14 09:59:06,781 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__1100116909" (base.py:2113)
2025-03-14 09:59:06,783 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__1100116909" AS "sqlmesh_example__full_model__1100116909") AS "_q_0" WHERE "item_id" < 0) AS "audit" (base.py:2113)
2025-03-14 09:59:06,784 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2024-12-20 00:00:00, 2025-03-14 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3804180753> (interval.py:71)
2025-03-14 09:59:06,784 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3804180753> (interval.py:255)
2025-03-14 09:59:06,791 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_opp_history": 2691213078> (evaluator.py:594)
2025-03-14 09:59:06,794 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-03-13 00:00:00, 2025-03-14 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__sfdc_opp_history__796608424' (evaluator.py:648)
2025-03-14 09:59:06,795 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_opp_history__796608424" AS SELECT CAST("id" AS INT) AS "id", CAST("opportunity_name" AS TEXT) AS "opportunity_name", CAST("opportunity_stage" AS TEXT) AS "opportunity_stage", CAST("close_date" AS DATE) AS "close_date", CAST("expected_amount" AS DOUBLE) AS "expected_amount", CAST("opportunity_probability_new" AS DOUBLE) AS "opportunity_probability_new" FROM (SELECT "sfdc_pipeline"."id" AS "id", "sfdc_pipeline"."opportunity_name" AS "opportunity_name", "sfdc_pipeline"."opportunity_stage" AS "opportunity_stage", "sfdc_pipeline"."close_date" AS "close_date", "sfdc_pipeline"."expected_amount" AS "expected_amount", "sfdc_pipeline"."opportunity_probability_new" AS "opportunity_probability_new" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__sfdc_pipeline__3294888737" AS "sfdc_pipeline") AS "_subquery" (base.py:2113)
2025-03-14 09:59:06,796 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Adding interval (2025-03-13 00:00:00, 2025-03-14 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_opp_history": 2691213078> (interval.py:71)
2025-03-14 09:59:06,796 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."sfdc_opp_history": 2691213078> (interval.py:255)
2025-03-14 09:59:06,812 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
